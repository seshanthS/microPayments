<html>
    <head>
        <script src="dist/jquery-3.3.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.dev.js"></script>
        <script type="text/javascript" src="dist/web3.js"></script>
        <script type="text/javascript" src ="js/functions.js"></script>
       
    </head>
    <body>
        <label for="keyField">key</label>
        <input type="text" id = "keyField" />
        <label for="passwordTextEncrypt">password</label>
        <input type="password" id="passwordTextEncrypt">
        <input type ="button" id="encryptBtn" value="Encrypt And Save" onclick="encryptKey()"/>
        <!--add divider here-->
        <br><br>
        <form>
        <input type="radio" name="option" value="signOption" onclick="radioClicked(this)" checked >sign
        <input type="radio" name="option" value="createOption" onclick="radioClicked(this)">create Channel
        <input type="radio" name="option" value="withdrawOption" onclick="radioClicked(this)">withdraw
        <input type="radio" name="option" value="verifyOption" onclick="radioClicked(this)">verify<br>
        </form>
        
        <form id="signForm">
            <h3>SignForm</h3>
            <label for="keyFileBrowser">select File</label>
            <input type ="file" id="keyFileBrowser" name = "files[]" value = "select the encrypted key file"
            accept=".paymentKey"/>
            <label for="amountText">Amount</label>
            <input type="number" name="amount" id="amountText">
            <br>
            <label for="passwordText">password</label>
            <input type = "password" value = password id="passwordText" />
            <br>
            <input type="button" value="sign" id="signBtn" onclick="sign('keyFileBrowser')">
            <h4 id = "signatureDisplay">test</h4>
        </form>

        <form id="channelCreationForm">
            <h3>Create Channel</h3>
            <label for="keyFileBrowserChannel">select File</label>
            <input type ="file" id="keyFileBrowserChannel" name = "files[]" value = "select the encrypted key file"
            accept=".paymentKey"/>
            <label for="passwordText">password</label>
            <input type = "password" value = password id="passwordText" />
            <br>
            <label for="receiverText">Receiver Address</label>
            <input type="text" value="receiver" id="receiverText">
            <br>
            <label for="amountChannel">Amount In Ethers</label>
            <input type="number" id="amountChannel">
            <br>
            
            <input type="button" value="Create Channel" id="createChannelBtn" onclick="createChannel('keyFileBrowserChannel')">
        </form>

        <form id="withdrawForm">
            <h3>WithdrawForm</h3>
            <label for="keyFileBrowserWithdraw">select File</label>
            <input type ="file" id="keyFileBrowserWithdraw" name = "files[]" value = "select the encrypted key file"
            accept=".paymentKey"/>
            <label for="amountTextWithdraw">Amount</label>
            <input type="number" name="amount" id="amountTextWithdraw">
            <br>
            <label for="passwordTextWithdraw">password</label>
            <input type = "password" value = password id="passwordTextWithdraw" />
            <br>
            <label for="channelIdWithdraw">ChannelId</label>
            <input type = "number" id="channelIdWithdraw" />
            <label for="signatureFieldWithdraw">select File</label>
            <input type ="file" id="signatureFieldWithdraw" name = "files[]" value = "select the signature file"
            accept=".signature"/>
            <br>
            <input type="button" value="withdraw" id="withdrawBtn" onclick="withdraw('keyFileBrowserWithdraw')">
        </form>

        <form id="verifyForm">
            <h3>Verify Amount</h3>
            <label for="signatureFile">signature File</label>
            <input type ="file" id="signatureFile" name = "files[]" value = "select the signature file"/>
            <label for="amountVerifyField">amount</label>
            <input type="number"  id="amountVerifyField">
            <input type="button" value="Verify" id="verifyBtn" onclick="verifyAmount('signatureFile')">
            <div id="Verificationresult"></div>
        </form>
        <br><br>
        <h3>status</h3>
        <div id="status"></div>
        <script>
            //todo display modal dialog to show statusclear
            var socket = io('http://localhost:3000');
            socket.on('transactionHash', function (transactionHash) {
            console.log(transactionHash);
            alert("Transaction Started \n TransactionHash: " + transactionHash)
            });

            socket.on('receipt', function (receipt) {
            console.log(receipt);
            delete(alert);
            var receiptStringified = JSON.stringify(receipt)
            alert("Transaction Successful \n Receipt: " + receiptStringified)
            });

            socket.on('error', function (err) {
            console.log(err);
            var errString = JSON.stringify(err)
            alert("An error occured :( \n " + errString)
            });

            $(document).ready(()=>{                    
                $("#signForm").css("display","block")
                $("#channelCreationForm").css("display","none")
                $("#verifyForm").css("display","none")
                $("#withdrawForm").css("display","none")   
            });
/*
            $("#encryptBtn").click(encryptKey());
            $("#createChannelBtn").click(createChannel('keyFileBrowserChannel'));
            $("#withdrawBtn").click(withdraw('keyFileBrowserWithdraw'));
            $("#signBtn").click(sign('keyFileBrowser'));
         // not needed   document.getElementById('files').addEventListener('change', readFromFile, false);  
            $("#verifyBtn").click(verifyAmount(signatureField));
*/

            function radioClicked(radioBtn){
                switch(radioBtn.value){
                    case "signOption" :
                    console.log("1");
                    $("#signForm").css("display","block")
                    $("#channelCreationForm").css("display","none")
                    $("#verifyForm").css("display","none")
                    $("#withdrawForm").css("display","none")   
                    break;

                    case "createOption" :
                    console.log("2")
                    $("#signForm").css("display","none")
                    $("#channelCreationForm").css("display","block")
                    $("#verifyForm").css("display","none")
                    $("#withdrawForm").css("display","none")   
                    break;

                    case "withdrawOption" :
                    console.log("2")
                    $("#signForm").css("display","none")
                    $("#channelCreationForm").css("display","none")
                    $("#verifyForm").css("display","none")
                    $("#withdrawForm").css("display","block")                  
                    break;

                    case "verifyOption" :
                    console.log("2")
                    $("#signForm").css("display","none")
                    $("#channelCreationForm").css("display","none")
                    $("#verifyForm").css("display","block")
                    $("#withdrawForm").css("display","none")   
                    break;

                }
                 
            }
            
        </script>
    </body>
</html>